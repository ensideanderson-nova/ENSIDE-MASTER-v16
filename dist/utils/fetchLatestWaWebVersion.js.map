{"version":3,"sources":["../../src/utils/fetchLatestWaWebVersion.ts"],"sourcesContent":["import axios, { AxiosRequestConfig } from 'axios';\nimport { fetchLatestBaileysVersion, WAVersion } from 'baileys';\n\nexport const fetchLatestWaWebVersion = async (options: AxiosRequestConfig<{}>) => {\n  try {\n    const { data } = await axios.get('https://web.whatsapp.com/sw.js', {\n      ...options,\n      responseType: 'json',\n    });\n\n    const regex = /\\\\?\"client_revision\\\\?\":\\s*(\\d+)/;\n    const match = data.match(regex);\n\n    if (!match?.[1]) {\n      return {\n        version: (await fetchLatestBaileysVersion()).version as WAVersion,\n        isLatest: false,\n        error: {\n          message: 'Could not find client revision in the fetched content',\n        },\n      };\n    }\n\n    const clientRevision = match[1];\n\n    return {\n      version: [2, 3000, +clientRevision] as WAVersion,\n      isLatest: true,\n    };\n  } catch (error) {\n    return {\n      version: (await fetchLatestBaileysVersion()).version as WAVersion,\n      isLatest: false,\n      error,\n    };\n  }\n};\n"],"mappings":"gmBAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,6BAAAE,IAAA,eAAAC,EAAAH,GAAA,IAAAI,EAA0C,oBAC1CC,EAAqD,mBAE9C,IAAMC,EAA0BC,EAAA,MAAOC,GAAAA,CAC5C,GAAI,CACF,GAAM,CAAEC,KAAAA,CAAI,EAAK,MAAMC,EAAAA,QAAMC,IAAI,iCAAkC,CACjE,GAAGH,EACHI,aAAc,MAChB,CAAA,EAEMC,EAAQ,mCACRC,EAAQL,EAAKK,MAAMD,CAAAA,EAEzB,OAAKC,IAAQ,CAAA,EAYN,CACLC,QAAS,CAAC,EAAG,IAAM,CAHED,EAAM,CAAA,GAI3BE,SAAU,EACZ,EAdS,CACLD,SAAU,QAAME,6BAAAA,GAA6BF,QAC7CC,SAAU,GACVE,MAAO,CACLC,QAAS,uDACX,CACF,CASJ,OAASD,EAAO,CACd,MAAO,CACLH,SAAU,QAAME,6BAAAA,GAA6BF,QAC7CC,SAAU,GACVE,MAAAA,CACF,CACF,CACF,EAjCuC","names":["fetchLatestWaWebVersion_exports","__export","fetchLatestWaWebVersion","__toCommonJS","import_axios","import_baileys","fetchLatestWaWebVersion","__name","options","data","axios","get","responseType","regex","match","version","isLatest","fetchLatestBaileysVersion","error","message"]}