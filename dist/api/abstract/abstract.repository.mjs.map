{"version":3,"sources":["../../../src/config/path.config.ts","../../../src/api/abstract/abstract.repository.ts"],"sourcesContent":["import { join } from 'path';\n\nexport const ROOT_DIR = process.cwd();\nexport const INSTANCE_DIR = join(ROOT_DIR, 'instances');\nexport const SRC_DIR = join(ROOT_DIR, 'src');\nexport const AUTH_DIR = join(ROOT_DIR, 'store', 'auth');\nexport const STORE_DIR = join(ROOT_DIR, 'store');\n","import { ConfigService, Database } from '@config/env.config';\nimport { ROOT_DIR } from '@config/path.config';\nimport { existsSync, mkdirSync, writeFileSync } from 'fs';\nimport { join } from 'path';\n\nexport type IInsert = { insertCount: number };\n\nexport interface IRepository {\n  insert(data: any, instanceName: string, saveDb?: boolean): Promise<IInsert>;\n  update(data: any, instanceName: string, saveDb?: boolean): Promise<IInsert>;\n  find(query: any): Promise<any>;\n  delete(query: any, force?: boolean): Promise<any>;\n\n  dbSettings: Database;\n  readonly storePath: string;\n}\n\ntype WriteStore<U> = {\n  path: string;\n  fileName: string;\n  data: U;\n};\n\nexport abstract class Repository implements IRepository {\n  constructor(configService: ConfigService) {\n    this.dbSettings = configService.get<Database>('DATABASE');\n  }\n\n  dbSettings: Database;\n  readonly storePath = join(ROOT_DIR, 'store');\n\n  public writeStore = <T = any>(create: WriteStore<T>) => {\n    if (!existsSync(create.path)) {\n      mkdirSync(create.path, { recursive: true });\n    }\n    try {\n      writeFileSync(join(create.path, create.fileName + '.json'), JSON.stringify({ ...create.data }), {\n        encoding: 'utf-8',\n      });\n\n      return { message: 'create - success' };\n    } finally {\n      create.data = undefined;\n    }\n  };\n\n  // eslint-disable-next-line\n    public insert(data: any, instanceName: string, saveDb = false): Promise<IInsert> {\n    throw new Error('Method not implemented.');\n  }\n\n  // eslint-disable-next-line\n    public update(data: any, instanceName: string, saveDb = false): Promise<IInsert> {\n    throw new Error('Method not implemented.');\n  }\n\n  // eslint-disable-next-line\n    public find(query: any): Promise<any> {\n    throw new Error('Method not implemented.');\n  }\n\n  // eslint-disable-next-line\n    delete(query: any, force?: boolean): Promise<any> {\n    throw new Error('Method not implemented.');\n  }\n}\n"],"mappings":"uNAAA,OAASA,QAAAA,MAAY,OAEd,IAAMC,EAAWC,QAAQC,IAAG,EACtBC,EAAeJ,EAAKC,EAAU,WAAA,EAC9BI,EAAUL,EAAKC,EAAU,KAAA,EACzBK,EAAWN,EAAKC,EAAU,QAAS,MAAA,EACnCM,EAAYP,EAAKC,EAAU,OAAA,ECJxC,OAASO,cAAAA,EAAYC,aAAAA,EAAWC,iBAAAA,MAAqB,KACrD,OAASC,QAAAA,MAAY,OAoBd,IAAeC,EAAf,MAAeA,CAAAA,CACpB,YAAYC,EAA8B,CAI1CC,EAAAA,mBACSC,EAAAA,iBAAYC,EAAKC,EAAU,OAAA,GAE7BC,EAAAA,kBAAaC,EAAUC,GAAAA,CACvBC,EAAWD,EAAOE,IAAI,GACzBC,EAAUH,EAAOE,KAAM,CAAEE,UAAW,EAAK,CAAA,EAE3C,GAAI,CACFC,OAAAA,EAAcT,EAAKI,EAAOE,KAAMF,EAAOM,SAAW,OAAA,EAAUC,KAAKC,UAAU,CAAE,GAAGR,EAAOS,IAAK,CAAA,EAAI,CAC9FC,SAAU,OACZ,CAAA,EAEO,CAAEC,QAAS,kBAAmB,CACvC,QAAA,CACEX,EAAOS,KAAOG,MAChB,CACF,EAboB,eANlB,KAAKlB,WAAaD,EAAcoB,IAAc,UAAA,CAChD,CAqBSC,OAAOL,EAAWM,EAAsBC,EAAS,GAAyB,CACjF,MAAM,IAAIC,MAAM,yBAAA,CAClB,CAGSC,OAAOT,EAAWM,EAAsBC,EAAS,GAAyB,CACjF,MAAM,IAAIC,MAAM,yBAAA,CAClB,CAGSE,KAAKC,EAA0B,CACtC,MAAM,IAAIH,MAAM,yBAAA,CAClB,CAGEI,OAAOD,EAAYE,EAA+B,CAClD,MAAM,IAAIL,MAAM,yBAAA,CAClB,CACF,EA1CsBzB,EAAAA,EAAAA,cAAf,IAAeA,EAAf+B","names":["join","ROOT_DIR","process","cwd","INSTANCE_DIR","SRC_DIR","AUTH_DIR","STORE_DIR","existsSync","mkdirSync","writeFileSync","join","Repository","configService","dbSettings","storePath","join","ROOT_DIR","writeStore","__name","create","existsSync","path","mkdirSync","recursive","writeFileSync","fileName","JSON","stringify","data","encoding","message","undefined","get","insert","instanceName","saveDb","Error","update","find","query","delete","force","_Repository"]}