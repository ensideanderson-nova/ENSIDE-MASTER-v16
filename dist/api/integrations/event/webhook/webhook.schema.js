var r=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.prototype.hasOwnProperty;var p=(n,e,t)=>e in n?r(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var o=(n,e)=>r(n,"name",{value:e,configurable:!0});var u=(n,e)=>{for(var t in e)r(n,t,{get:e[t],enumerable:!0})},_=(n,e,t,E)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of h(e))!m.call(n,s)&&s!==t&&r(n,s,{get:()=>e[s],enumerable:!(E=A(e,s))||E.enumerable});return n};var c=n=>_(r({},"__esModule",{value:!0}),n);var i=(n,e,t)=>p(n,typeof e!="symbol"?e+"":e,t);var P={};u(P,{webhookSchema:()=>N});module.exports=c(P);var T=require("uuid");var a=class a{constructor(e,t,E,s){i(this,"prismaRepository");i(this,"waMonitor");i(this,"integrationStatus");i(this,"integrationName");this.prisma=e,this.monitor=t,this.status=E,this.name=s}set prisma(e){this.prismaRepository=e}get prisma(){return this.prismaRepository}set monitor(e){this.waMonitor=e}get monitor(){return this.waMonitor}set name(e){this.integrationName=e}get name(){return this.integrationName}set status(e){this.integrationStatus=e}get status(){return this.integrationStatus}async set(e,t){if(this.status)return t[this.name]?.enabled?t[this.name].events.length===0&&(t[this.name].events=a.events):t[this.name].events=[],this.prisma[this.name].upsert({where:{instanceId:this.monitor.waInstances[e].instanceId},update:{enabled:t[this.name]?.enabled,events:t[this.name].events},create:{enabled:t[this.name]?.enabled,events:t[this.name].events,instanceId:this.monitor.waInstances[e].instanceId}})}async get(e){if(!this.status)return;if(this.monitor.waInstances[e]===void 0)return null;let t=await this.prisma[this.name].findUnique({where:{instanceId:this.monitor.waInstances[e].instanceId}});return t||null}};o(a,"EventController"),i(a,"events",["APPLICATION_STARTUP","QRCODE_UPDATED","MESSAGES_SET","MESSAGES_UPSERT","MESSAGES_EDITED","MESSAGES_UPDATE","MESSAGES_DELETE","SEND_MESSAGE","SEND_MESSAGE_UPDATE","CONTACTS_SET","CONTACTS_UPSERT","CONTACTS_UPDATE","PRESENCE_UPDATE","CHATS_SET","CHATS_UPSERT","CHATS_UPDATE","CHATS_DELETE","GROUPS_UPSERT","GROUP_UPDATE","GROUP_PARTICIPANTS_UPDATE","CONNECTION_UPDATE","LABELS_EDIT","LABELS_ASSOCIATION","CALL","TYPEBOT_START","TYPEBOT_CHANGE_STATUS","REMOVE_INSTANCE","LOGOUT_INSTANCE","INSTANCE_CREATE","INSTANCE_DELETE","STATUS_INSTANCE"]);var S=a;var I=o((...n)=>{let e={};return n.forEach(t=>e[t]={minLength:1,description:`The "${t}" cannot be empty`}),{if:{propertyNames:{enum:[...n]}},then:{properties:e}}},"isNotEmpty"),N={$id:(0,T.v4)(),type:"object",properties:{webhook:{type:"object",properties:{enabled:{type:"boolean"},url:{type:"string"},headers:{type:"object"},byEvents:{type:"boolean"},base64:{type:"boolean"},events:{type:"array",minItems:0,items:{type:"string",enum:S.events}}},required:["enabled","url"],...I("enabled","url")}},required:["webhook"]};0&&(module.exports={webhookSchema});
//# sourceMappingURL=webhook.schema.js.map